<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />




<main>
<div class="producto-detalle-container">
  <div *ngIf="cargando">Cargando producto...</div>
  <ng-container *ngIf="!cargando && producto; else noProducto">
    <div>
      <img 
        *ngIf="imagenSeleccionada" 
        [src]="imagenSeleccionada" 
        alt="Imagen de la prenda" 
        class="producto-imagen"
        style="margin-bottom: 12px;"
      >

      <div class="miniaturas-container" style="display: flex; gap: 8px; justify-content: center; margin-top: 10px;">
        <img 
          *ngIf="producto.imagenPrincipal"
          [src]="producto.imagenPrincipal"
          alt="Principal"
          class="miniatura"
          [class.miniatura-seleccionada]="imagenSeleccionada === producto.imagenPrincipal"
          (click)="seleccionarImagen(producto.imagenPrincipal)"
          style="width: 60px; height: 60px; object-fit: cover; border-radius: 6px; border: 2px solid #ccc; cursor: pointer;"
        >
        <img 
          *ngFor="let img of producto.imagenesSecundarias"
          [src]="img"
          alt="Secundaria"
          class="miniatura"
          [class.miniatura-seleccionada]="imagenSeleccionada === img"
          (click)="seleccionarImagen(img)"
          style="width: 60px; height: 60px; object-fit: cover; border-radius: 6px; border: 2px solid #ccc; cursor: pointer;"
        >
      </div>
    </div>
    <div>
      <h1 id="nombre">{{ producto.nombre }}</h1>
      <p> ${{ producto.precio }}</p>
      <div>
        <strong>Talle</strong>
        <div class="talles-fila">
  <button 
    *ngFor="let talle of (producto.talles | keyvalue)" 
    type="button"
    [class.talle-seleccionado]="talleSeleccionado === talle.key"
    class="talle-cuadro"
    (click)="talleSeleccionado = talle.key">
    {{ talle.key }} 
    <span style="font-size: 0.9em; color: #888;">({{ talle.value }} disponibles)</span>
  </button>
</div>
      </div>
      <div class="guia-talles-container" (click)="abrirGuiaTalles()" tabindex="0" role="button" aria-label="Guía de talles">
        <span class="material-symbols-outlined">straighten</span>
        <span class="guia-talles-text">Guía de talles</span>
      </div>
      <div *ngIf="mostrarGuiaTalles" class="popup-overlay" (click)="cerrarGuiaTalles()">
        <div class="popup-content" (click)="$event.stopPropagation()">
          <img src="https://acdn-us.mitiendanube.com/stores/001/596/994/products/campera-melo-fc909d79cf0e9e138017562155646530-1024-1024.jpg" style="max-width:100%;max-height:80vh;">
          <button class="cerrar-popup" (click)="cerrarGuiaTalles()">Cerrar</button>
        </div>
      </div>
      <div style="display: flex; align-items: center; gap: 12px; margin-top: 18px;">
        <div class="cantidad-selector">
          <button type="button" class="cantidad-btn" (click)="bajarCantidad()">-</button>
          <div class="cantidad-valor">{{ cantidad }}</div>
          <button type="button" class="cantidad-btn" (click)="subirCantidad()">+</button>
        </div>
        <button class="agregar-carrito" (click)="agregarAlCarrito()">Agregar al carrito</button>
        <button class="volver" (click)="volver()">Volver</button>
        <div *ngIf="mensajeError" class="error">{{ mensajeError }}</div>
        <div *ngIf="mensajeExito" class="exito">{{ mensajeExito }}</div>
      </div>
    </div>
  </ng-container>
  <ng-template #noProducto>
    <div class="no-producto">No se encontró el producto.</div>
  </ng-template>
</div>
</main>