<p>Inicio    -   Mi cuenta</p>

<div *ngIf="mensajeError" class="error">{{ mensajeError }}</div>

<div *ngIf="!logeado">
    <h1>Debe Iniciar Sesion</h1>
    <button (click)="redirigirLogin()">Ir a Iniciar Sesion</button>
</div>

<div class="info" *ngIf="logeado">
    <div>
        <h1>Mi cuenta</h1>
        <p>Datos Personales</p>
        <hr>
        <p>{{ nombre }}</p>
        <p>{{ email }}</p>
        <button (click)="cerrarSesion()">Cerrar Sesion</button>
    </div>
    <div>
        <h1>Compras</h1>
        <p>Compras realizadas por el usuario</p>
        <hr>
        <p *ngIf="compras.length === 0">No tienes compras. <a href="/carrito">Hacer una</a></p>
        <div *ngIf="compras.length > 0" class="carrusel">
            <button 
                class="carrusel-arrow"
                (click)="prevCompra()"
                [disabled]="compraIndex === 0"
                *ngIf="compras.length > 1"
                aria-label="Anterior">&#8592;</button>
            <ul>
                <li *ngIf="compras[compraIndex]" class="reclamo-card">
                    <p>Fecha: {{ compras[compraIndex].fecha | date:'short' }}</p>
                    <p>Precio: {{ compras[compraIndex].total | currency:'ARS':'symbol':'1.2-2' }}</p>
                    <div>
                        <ul>
                            <li *ngFor="let producto of compras[compraIndex].productos">
                                {{ producto.nombre }}
                            </li>
                        </ul>
                    </div>
                    <p class="reclamo-estado">Estado: {{ compras[compraIndex].estado }}</p>
                    <button (click)="opinar(compras[compraIndex])">Dejar Opinion</button>
                </li>
            </ul>
            <button 
                class="carrusel-arrow"
                (click)="nextCompra()"
                [disabled]="compraIndex === compras.length - 1"
                *ngIf="compras.length > 1"
                aria-label="Siguiente">&#8594;</button>
        </div>
    </div>
    <div>
        <h1>Reclamos</h1>
        <p>Reclamos realizados por el usuario</p>
        <hr>
        <div *ngIf="reclamos.length === 0">
            <p>No tienes reclamos. <a href="/reclamo">Hacer uno</a></p>
        </div>
        <div *ngIf="reclamos.length > 0" class="carrusel">
            <button 
                class="carrusel-arrow"
                (click)="prevReclamo()"
                [disabled]="reclamoIndex === 0"
                *ngIf="reclamos.length > 1"
                aria-label="Anterior">&#8592;</button>
            <ul>
                <li *ngIf="reclamos[reclamoIndex]" class="reclamo-card">
                    <p>{{ reclamos[reclamoIndex].tipo }}</p>
                    <p>{{ reclamos[reclamoIndex].descripcion }}</p>
                    <p class="reclamo-estado">Estado: {{ reclamos[reclamoIndex].estado }}</p>
                    <button (click)="eliminarReclamo(reclamos[reclamoIndex].id)">Eliminar Reclamo</button>
                </li>
            </ul>
            <button 
                class="carrusel-arrow"
                (click)="nextReclamo()"
                [disabled]="reclamoIndex === reclamos.length - 1"
                *ngIf="reclamos.length > 1"
                aria-label="Siguiente">&#8594;</button>
        </div>
    </div>
    <div>
        <h1>Opiniones</h1>
        <p>Opiniones realizadas por el usuario</p>
        <hr>
        <p *ngIf="opiniones.length === 0">No tienes opiniones.</p>
        <div *ngIf="opiniones.length > 0" class="carrusel">
            <button 
                class="carrusel-arrow"
                (click)="prevOpinion()"
                [disabled]="opinionIndex === 0"
                *ngIf="opiniones.length > 1"
                aria-label="Anterior">&#8592;</button>
            <ul>
                <li *ngIf="opiniones[opinionIndex]" class="reclamo-card">
                    <div>
                        <ul>
                            <li *ngFor="let producto of getProductosDeOpinion(opiniones[opinionIndex])">
                                {{ producto.nombre }}
                            </li>
                        </ul>
                    </div>
                    <p>Calificaci√≥n: {{ opiniones[opinionIndex].calificacion }} / 5</p>
                    <p>Comentario: {{ opiniones[opinionIndex].comentario }}</p>
                    <button (click)="eliminarOpinion(opiniones[opinionIndex].id)" >Eliminar Opinion</button>
                </li>
            </ul>
            <button 
                class="carrusel-arrow"
                (click)="nextOpinion()"
                [disabled]="opinionIndex === opiniones.length - 1"
                *ngIf="opiniones.length > 1"
                aria-label="Siguiente">&#8594;</button>
        </div>
    </div>
</div>